<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NFC Student ID Reader</title>
</head>
<body>
    <button id="scan">Scan NFC Tag</button>
    <p id="studentId">Student ID will appear here.</p>

    <script>
        document.getElementById('scan').addEventListener('click', async () => {
            if ('NDEFReader' in window) {
                try {
                    const reader = new NDEFReader();
                    await reader.scan();

                    reader.onreading = event => {
                        for (const record of event.message.records) {
                            console.log("Record type: " + record.recordType);
                            let textContent = "";

                            switch (record.recordType) {
                                case "text":
                                    // Directly decode text records
                                    const textDecoder = new TextDecoder();
                                    textContent = textDecoder.decode(record.data);
                                    break;
                                case "url":
                                    // URLs are stored as strings, so direct conversion is possible
                                    textContent = new TextDecoder().decode(record.data);
                                    break;
                                case "mime":
                                    if (record.mediaType === "application/json") {
                                        // Example: Decode JSON content
                                        const jsonText = new TextDecoder().decode(record.data);
                                        const jsonObj = JSON.parse(jsonText);
                                        textContent = JSON.stringify(jsonObj, null, 2); // Formatting JSON for display
                                    } else {
                                        // Handle other MIME types as needed
                                        textContent = "MIME type data received, specific handling needed.";
                                    }
                                    break;
                                default:
                                    textContent = "Unsupported record type.";
                                    break;
                            }

                            // Update the UI with the text/content from the NFC tag
                            document.getElementById('studentId').textContent = `Data: ${textContent}`;
                        }
                    };
                    console.log("NFC reader is scanning...");
                } catch (error) {
                    console.error(`Error: ${error}.`);
                }
            } else {
                console.log("Web NFC is not supported.");
                alert("Web NFC is not supported on this browser/device.");
            }
        });
    </script>
</body>
</html>
